import networkx as nx
import numpy as np
import time
import graph_tools as gt
import matplotlib.pyplot as plt
from random import randint, sample
import igraph as ig
from scipy.stats import qmc
from tqdm import tqdm
import multiprocessing as mp



#蒙特卡洛模拟
def m_c(K, G, p_vi, Seq):
    sum = 0
    N = len(G.nodes)
    for j in tqdm(range(K)):
        X = []
        r = np.random.rand(N, 1)
        for i in range(N):
            if r[i] > p_vi[i]:
                X.append(0)
            else:
                X.append(1)
        sum += gt.ANC_ND_X(G, Seq, X)
    return sum/K

# #拟蒙特卡洛模拟
# def q_m_c(K, G, p_vi, Seq):
#     res = []
#     sum = 0
#     N = len(G.nodes)
#     sobol = qmc.Sobol(N)
#     for j in tqdm(range(K)):
#         X = []
#         r = sobol.random(1)[0]
#         for i in range(N):
#             if r[i] > p_vi[i]:
#                 X.append(0)
#             else:
#                 X.append(1)
#         sum += gt.getRobustness_ND_COST_X(G, Seq, X)
#         res.append(sum/(j+1))
#     return res

def q_m_c(K, G, p_vi, Seq):
    res = []
    sum = 0
    N = len(G.nodes)
    sobol = qmc.Sobol(N)
    for j in tqdm(range(K)):
        X = []
        r = sobol.random(N)[0]

        for i in range(N):
            if r[i] > p_vi[i]:
                X.append(0)
            else:
                X.append(1)
        sum += gt.getRobustness_ND_COST_X(G, Seq, X)
        res.append(sum/(j+1))
    return res


#蒙特卡洛模拟

data = 'Karate'
infile = '../data/' + data + '.gml'
G = nx.read_gml(infile)

# Karate
Seq = ['33', '0', '32', '1', '2', '3', '5', '25', '4', '23', '24', '6', '8', '28', '29', '19', '20', '12', '13', '22', '17', '31', '21', '11', '16', '26', '27', '9', '14', '10', '15', '18', '30', '7']
N = 34
# # Krebs
# Seq = ['1', '11', '14', '15', '7', '20', '12', '29', '22', '25', '28', '2', '5', '49', '27', '53', '19', '34', '6', '43', '40', '45', '23', '47', '30', '26', '46', '35', '52', '54', '33', '9', '36', '37', '56', '13', '55', '18', '39', '32', '48', '51', '3', '59', '42', '16', '44', '41', '4', '38', '24', '57', '60', '0', '50', '17', '21', '61', '31', '10', '8', '58']
# N = 62
# # Airport
# Seq = ['117', '7', '260', '181', '151', '254', '165', '66', '46', '200', '143', '257', '247', '64', '141', '229', '218', '292', '262', '111', '202', '175', '273', '160', '132', '216', '161', '231', '176', '166', '93', '220', '146', '298', '145', '173', '295', '291', '171', '178', '130', '108', '149', '300', '283', '272', '310', '312', '118', '142', '44', '191', '129', '212', '70', '261', '12', '82', '182', '122', '25', '81', '67', '255', '196', '217', '59', '244', '287', '136', '49', '55', '74', '315', '306', '275', '170', '265', '54', '115', '72', '100', '320', '205', '280', '35', '61', '119', '326', '8', '31', '60', '58', '245', '232', '84', '201', '215', '282', '0', '9', '19', '28', '45', '56', '65', '309', '91', '99', '156', '147', '248', '241', '317', '328', '316', '3', '4', '6', '22', '15', '27', '33', '36', '18', '52', '57', '48', '97', '77', '94', '135', '124', '95', '105', '96', '106', '102', '296', '162', '187', '228', '134', '163', '123', '324', '297', '323', '270', '219', '194', '227', '269', '238', '92', '116', '253', '327', '89', '204', '2', '243', '190', '318', '179', '71', '226', '236', '16', '13', '198', '308', '172', '222', '40', '5', '39', '168', '103', '41', '239', '242', '250', '101', '267', '157', '38', '169', '185', '90', '286', '86', '184', '252', '209', '210', '23', '207', '85', '29', '69', '11', '113', '221', '152', '271', '264', '21', '230', '276', '274', '88', '153', '87', '138', '155', '290', '110', '299', '30', '51', '304', '148', '127', '32', '284', '128', '107', '279', '47', '206', '301', '329', '62', '131', '140', '193', '53', '223', '192', '330', '20', '246', '303', '266', '78', '189', '288', '325', '112', '76', '10', '224', '211', '83', '277', '158', '240', '256', '154', '322', '285', '14', '50', '225', '319', '305', '294', '237', '34', '104', '214', '293', '109', '68', '1', '75', '79', '174', '144', '281', '183', '278', '125', '197', '233', '167', '259', '195', '188', '321', '251', '98', '177', '313', '26', '213', '137', '150', '208', '17', '302', '37', '186', '42', '263', '43', '126', '121', '80', '203', '120', '268', '289', '63', '114', '180', '249', '314', '235', '159', '133', '234', '331', '258', '24', '311', '199', '73', '307', '164', '139']
# N = 332
# # Crime
# # Seq = ['814', '1', '109', '355', '219', '424', '38', '55', '513', '61', '87', '42', '152', '94', '473', '45', '111', '213', '403', '714', '13', '224', '114', '151', '160', '412', '77', '276', '383', '107', '496', '413', '548', '154', '335', '50', '658', '96', '36', '343', '404', '35', '796', '728', '56', '694', '735', '189', '241', '244', '332', '158', '130', '395', '689', '76', '296', '535', '215', '128', '591', '380', '695', '16', '73', '29', '250', '405', '333', '387', '346', '145', '576', '66', '514', '53', '662', '331', '173', '243', '86', '59', '451', '342', '532', '78', '27', '300', '571', '441', '51', '205', '32', '62', '530', '252', '57', '369', '253', '118', '299', '203', '139', '283', '235', '289', '409', '172', '378', '64', '362', '186', '397', '181', '334', '315', '344', '49', '293', '23', '262', '501', '810', '231', '115', '46', '261', '216', '479', '9', '218', '18', '11', '81', '766', '103', '434', '188', '168', '28', '10', '220', '415', '340', '171', '314', '159', '599', '93', '74', '489', '79', '155', '641', '396', '351', '43', '270', '323', '137', '370', '317', '303', '290', '34', '211', '12', '701', '84', '106', '113', '71', '242', '127', '0', '374', '787', '389', '85', '529', '482', '444', '247', '180', '782', '21', '368', '312', '360', '308', '322', '320', '512', '440', '136', '150', '156', '164', '217', '256', '294', '165', '20', '37', '264', '40', '438', '60', '423', '257', '325', '377', '382', '685', '240', '414', '502', '167', '393', '457', '309', '295', '198', '560', '292', '483', '226', '2', '5', '89', '22', '25', '691', '341', '161', '612', '373', '69', '67', '98', '232', '379', '248', '394', '492', '88', '204', '170', '176', '125', '450', '722', '511', '433', '635', '291', '135', '191', '443', '268', '208', '437', '531', '381', '534', '493', '384', '715', '30', '24', '33', '716', '39', '41', '210', '47', '498', '784', '119', '724', '266', '353', '356', '663', '70', '547', '298', '263', '68', '129', '673', '811', '799', '518', '702', '90', '643', '271', '91', '182', '763', '678', '411', '762', '237', '536', '540', '657', '141', '110', '398', '665', '666', '183', '251', '121', '361', '307', '604', '684', '122', '573', '316', '419', '432', '798', '774', '467', '468', '358', '472', '528', '487', '670', '636', '459', '539', '584', '661', '174', '175', '503', '634', '214', '553', '202', '259', '554', '542', '739', '456', '827', '349', '765', '818', '812', '655', '196', '375', '627', '297', '190', '31', '470', '376', '515', '747', '310', '207', '400', '140', '517', '463', '134', '82', '458', '200', '744', '102', '596', '228', '687', '238', '688', '230', '743', '319', '589', '509', '465', '788', '551', '759', '537', '804', '388', '703', '620', '711', '507', '751', '499', '427', '520', '523', '48', '147', '686', '318', '429', '570', '609', '185', '229', '708', '225', '720', '761', '491', '425', '371', '522', '803', '504', '249', '364', '287', '731', '497', '752', '597', '357', '700', '733', '632', '575', '590', '54', '565', '786', '363', '422', '586', '567', '95', '19', '820', '754', '652', '732', '664', '740', '726', '255', '272', '206', '347', '618', '801', '455', '595', '138', '683', '65', '594', '508', '428', '783', '454', '321', '392', '675', '680', '408', '386', '516', '417', '462', '267', '448', '800', '727', '616', '212', '755', '598', '668', '828', '778', '328', '795', '474', '544', '288', '460', '809', '330', '779', '672', '717', '823', '822', '561', '805', '7', '410', '546', '4', '653', '116', '406', '756', '639', '58', '179', '352', '221', '760', '146', '367', '278', '97', '274', '592', '407', '646', '579', '273', '83', '558', '75', '710', '748', '692', '709', '519', '813', '633', '435', '126', '780', '746', '481', '525', '15', '676', '677', '279', '157', '750', '713', '192', '549', '63', '199', '654', '52', '582', '768', '163', '275', '99', '802', '495', '490', '568', '464', '566', '712', '14', '578', '753', '538', '647', '418', '725', '659', '327', '621', '638', '705', '602', '399', '587', '642', '797', '793', '281', '193', '696', '637', '345', '372', '606', '577', '494', '100', '306', '131', '286', '366', '484', '773', '209', '623', '184', '461', '608', '304', '354', '421', '815', '453', '350', '737', '426', '258', '669', '648', '510', '476', '645', '447', '486', '610', '574', '806', '730', '622', '524', '284', '757', '630', '475', '222', '505', '280', '223', '794', '305', '162', '660', '789', '769', '477', '420', '17', '775', '311', '771', '679', '585', '543', '619', '142', '583', '541', '26', '533', '201', '807', '562', '563', '80', '478', '767', '329', '44', '671', '734', '348', '324', '600', '749', '550', '629', '430', '236', '187', '729', '699', '338', '480', '6', '132', '690', '469', '301', '124', '527', '564', '326', '649', '149', '488', '500', '195', '736', '445', '365', '239', '254', '552', '697', '559', '555', '772', '439', '442', '721', '485', '557', '644', '719', '581', '269', '656', '285', '72', '302', '651', '704', '615', '792', '826', '133', '698', '667', '471', '706', '824', '611', '776', '614', '336', '745', '674', '246', '588', '816', '693', '569', '105', '521', '234', '781', '718', '742', '631', '313', '391', '707', '819', '791', '556', '92', '120', '601', '681', '402', '197', '446', '101', '506', '624', '764', '821', '8', '169', '580', '613', '777', '277', '466', '790', '260', '233', '682', '738', '452', '245', '572', '385', '436', '178', '359', '337', '153', '194', '640', '166', '625', '117', '808', '390', '227', '545', '758', '104', '785', '123', '416', '431', '617', '143', '650', '144', '177', '449', '148', '3', '825', '401', '603', '265', '339', '526', '593', '605', '108', '282', '817', '626', '723', '770', '112', '607', '741', '628']
# #Finder
# Seq = ['814', '1', '424', '219', '55', '152', '109', '13', '42', '513', '160', '111', '114', '355', '154', '38', '412', '77', '86', '473', '61', '94', '35', '714', '87', '403', '78', '224', '213', '36', '189', '694', '186', '658', '695', '27', '276', '290', '96', '107', '343', '151', '591', '18', '49', '66', '261', '514', '413', '158', '530', '404', '59', '335', '241', '45', '434', '250', '441', '369', '23', '501', '689', '380', '395', '73', '289', '796', '728', '535', '244', '188', '145', '496', '766', '571', '50', '173', '548', '128', '34', '479', '342', '62', '296', '28', '81', '293', '205', '344', '451', '332', '270', '76', '150', '396', '576', '220', '127', '32', '16', '51', '532', '242', '103', '312', '300', '235', '137', '315', '314', '378', '299', '203', '60', '40', '303', '262', '53', '74', '599', '383', '118', '115', '641', '333', '787', '201', '216', '41', '405', '542', '231', '317', '387', '810', '215', '409', '211', '10', '79', '71', '325', '331', '85', '295', '43', '113', '308', '180', '370', '256', '247', '662', '46', '37', '510', '155', '489', '351', '294', '105', '110', '57', '164', '56', '93', '206', '106', '323', '218', '415', '181', '374', '202', '161', '0', '379', '2', '722', '529', '389', '165', '397', '21', '381', '440', '512', '398', '320', '340', '298', '782', '360', '100', '368', '322', '494', '414', '84', '39', '253', '198', '240', '309', '377', '438', '292', '226', '527', '338', '64', '482', '480', '471', '120', '808', '502', '33', '763', '500', '319', '52', '172', '515', '423', '419', '233', '685', '382', '364', '487', '175', '143', '547', '310', '549', '636', '307', '436', '827', '826', '279', '665', '372', '518', '357', '663', '764', '358', '751', '534', '288', '536', '564', '116', '724', '544', '139', '141', '142', '291', '345', '286', '488', '159', '393', '392', '715', '167', '171', '174', '324', '540', '539', '538', '130', '537', '267', '121', '443', '584', '773', '508', '228', '72', '432', '70', '596', '765', '375', '265', '266', '69', '68', '67', '281', '499', '498', '192', '337', '573', '330', '678', '362', '31', '626', '316', '91', '607', '258', '47', '89', '19', '20', '486', '523', '634', '119', '185', '361', '318', '691', '472', '798', '655', '586', '704', '117', '457', '442', '7', '8', '29', '30', '183', '222', '234', '632', '633', '643', '659', '661', '193', '136', '721', '313', '252', '509', '82', '168', '444', '239', '260', '102', '469', '101', '566', '97', '399', '268', '156', '140', '170', '204', '326', '134', '785', '311', '248', '817', '768', '600', '269', '770', '717', '384', '217', '341', '582', '580', '371', '437', '574', '123', '329', '461', '190', '692', '147', '149', '476', '620', '477', '712', '635', '462', '505', '511', '153', '577', '126', '706', '699', '435', '243', '122', '491', '490', '450', '428', '433', '54', '166', '232', '22', '418', '58', '352', '583', '408', '752', '237', '454', '729', '761', '595', '637', '713', '795', '426', '708', '767', '711', '624', '800', '274', '613', '597', '617', '445', '339', '365', '562', '506', '411', '492', '735', '478', '493', '657', '567', '825', '12', '669', '709', '350', '730', '737', '221', '779', '756', '63', '459', '822', '627', '707', '348', '177', '275', '614', '92', '668', '465', '585', '302', '497', '640', '394', '230', '526', '742', '277', '738', '135', '703', '651', '557', '647', '400', '271', '702', '406', '347', '543', '679', '616', '304', '775', '264', '17', '786', '799', '594', '104', '328', '618', '521', '449', '349', '367', '561', '568', '681', '464', '146', '777', '819', '749', '227', '280', '553', '99', '245', '698', '112', '238', '552', '353', '194', '282', '460', '75', '605', '133', '696', '257', '741', '197', '301', '283', '610', '781', '563', '688', '531', '673', '646', '606', '90', '725', '623', '15', '807', '545', '645', '421', '705', '65', '429', '533', '273', '598', '628', '820', '195', '727', '484', '653', '551', '272', '401', '207', '762', '804', '376', '686', '528', '593', '448', '559', '644', '467', '720', '575', '246', '793', '447', '129', '474', '723', '554', '131', '788', '676', '589', '255', '359', '790', '802', '769', '446', '407', '504', '700', '622', '569', '98', '746', '693', '592', '732', '803', '321', '346', '682', '710', '680', '675', '648', '656', '209', '199', '753', '805', '757', '771', '420', '212', '495', '570', '818', '667', '263', '718', '813', '83', '391', '816', '162', '755', '734', '516', '132', '208', '789', '612', '672', '225', '609', '546', '475', '284', '525', '9', '430', '80', '748', '740', '824', '26', '388', '187', '287', '629', '811', '778', '555', '588', '701', '452', '178', '182', '366', '541', '759', '481', '483', '455', '654', '456', '196', '327', '674', '25', '373', '306', '184', '124', '507', '176', '468', '743', '683', '214', '649', '604', '410', '639', '754', '828', '425', '631', '251', '463', '148', '138', '14', '386', '578', '439', '560', '278', '625', '48', '780', '5', '95', '772', '716', '6', '229', '572', '470', '249', '579', '336', '422', '3', '520', '677', '687', '24', '602', '823', '783', '806', '179', '11', '744', '690', '660', '390', '223', '733', '815', '608', '385', '88', '259', '615', '750', '334', '642', '664', '285', '354', '519', '466', '581', '4', '191', '792', '587', '556', '305', '812', '652', '797', '619', '402', '791', '44', '565', '747', '144', '736', '776', '638', '524', '670', '157', '774', '601', '163', '558', '697', '550', '621', '719', '210', '254', '821', '784', '809', '739', '503', '200', '731', '169', '125', '671', '745', '417', '726', '590', '458', '108', '485', '517', '356', '453', '684', '603', '431', '760', '801', '630', '522', '427', '416', '611', '758', '794', '666', '236', '363', '297', '650']
# N = 829

#初始概率
# p_vi = [1 for i in range(N)]
#重要节点加强
# for i in range(int(N*0.2)):
#     p_vi[i] -= 0.1
#随机节点加强
# index_A = [i for i in range(N)]
# S = sample(index_A, int(N*0.2))
# for i in S:
#     p_vi[i] -= 0.1

# 随机节点统一概率
# Karate
p_vi = [1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8]
# Krebs
# p_vi = [1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1]
# Airport
# p_vi = [1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 0.8, 0.8, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 0.8, 1, 0.8, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 0.8]
# Crime
# p_vi = [1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 0.8, 0.8, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 0.8, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 0.8, 0.8, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 0.8, 1, 0.8, 1, 0.8, 0.8, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 0.8, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 0.8, 1, 1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0.8, 0.8, 1, 0.8, 1, 1, 1, 1]


if __name__=="__main__":

    # print(p_vi)

    infile = '../data/' + data + '.gml'
    G = nx.read_gml(infile)
    K = 833


    # print("MC")
    # start = time.perf_counter()
    # Inv_mc = m_c(K, G, p_vi, Seq)
    # total_time = time.perf_counter() - start
    # print("time:", total_time * 1000, "ms")

    print("QMC")
    start = time.perf_counter()
    Inv_qmc = q_m_c(K, G, p_vi, Seq)
    print(Inv_qmc[-1])
    total_time = time.perf_counter() - start
    print("time:", total_time * 1000, "ms")



    # plt.rcParams.update({'font.size': 18, 'font.family': 'Times New Roman', 'mathtext.fontset': 'stix'})
    # plt.rcParams['figure.dpi'] = 400
    # TickSize = 11
    # LabelSize = 18
    # Labelpad = 5
    # LegendSize = 14
    # # Linewidth = 4
    # fig, ax = plt.subplots()
    # x = [i for i in range(len(Inv))]
    # ax.plot(x, Inv, color='r')
    # ax.set_ylabel('Inv', labelpad=Labelpad, fontweight='bold', fontsize=LabelSize)
    # ax.set_xlabel('times', fontweight='bold', fontsize=LabelSize)
    # ax.tick_params(axis='x', labelsize=TickSize)
    # ax.tick_params(axis='y', labelsize=TickSize)
    # fig.tight_layout()
    # fig.savefig('%s.png' % data, bbox_inches='tight')
